version: 1

name: codedeploy-test

tags:
  data-sensitivity: internal
  team: test

environments:
  dev:
    webapp:
      type: codedeploy
      path_to_code: . # Required. appspec.yml must be at the root of the directory provided
      instance_type: t2.micro # Optional. Default: t2.micro
      os: linux # Required. Only Linux supported at this time
      key_name: ces-dev # Optional
      # deployment: # Optional
      #   style: in-place # Optional
      #   config: halfatatime # Optional. Only support the default configuration types
      auto_scaling:
        min_instances: 1
        max_instances: 4
        scaling_policies:
        - type: up
          adjustment:
            value: 1
            cooldown: 60
          alarm:
            metric_name: CPUUtilization
            comparison_operator: GreaterThanThreshold
            threshold: 70
            period: 60
        - type: down
          adjustment:
            value: 1
            cooldown: 60
          alarm:
            metric_name: CPUUtilization
            comparison_operator: LessThanThreshold
            threshold: 30
            period: 60
      routing: # Optional, won't add routing if you don't specify it
        type: https
        https_certificate: c4a82252-b609-4f7c-aae8-83777377a0fd # Required if HTTPS
        dns_names: # Optional
        - codedeploytest.sim-dev.byu.edu
      environment_variables:
        MY_ENV_VAR: myValue
      tags:
        faketag: fakevalue
      dependencies:
      - mount
    mount:
      type: efs
      